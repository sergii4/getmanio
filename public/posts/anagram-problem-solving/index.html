<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Anagram Problem Solving | Terminal, command line, code</title>
  <meta name="description" content="Vim zsh go docker algorithms k8s. Coffee aeropress V60. Dog dachshund">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Anagram Problem Solving" />
<meta property="og:description" content="Anagram Problem Solving" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://getman.io/posts/anagram-problem-solving/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-20T13:41:25&#43;03:00" />
<meta property="article:modified_time" content="2020-05-20T13:41:25&#43;03:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Anagram Problem Solving"/>
<meta name="twitter:description" content="Anagram Problem Solving"/>

  
  
  
  <link rel="stylesheet" href="https://getman.io/css/style-white.css">
  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://getman.io/favicon.ico" />

  
  
  
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-163649901-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
  
  
  
  <meta name="keywords" content="algorithms go unicode lcd sort">
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">All posts</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://getman.io/posts/redis-delayed-tasks-with-go/">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://getman.io/posts/gopls/">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&text=Anagram%20Problem%20Solving">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&title=Anagram%20Problem%20Solving">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&is_video=false&description=Anagram%20Problem%20Solving">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Anagram%20Problem%20Solving&body=Check out this article: https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&title=Anagram%20Problem%20Solving">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&title=Anagram%20Problem%20Solving">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&title=Anagram%20Problem%20Solving">
      <i class="fab fa-stumbleupon " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&title=Anagram%20Problem%20Solving">
      <i class="fab fa-digg " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&name=Anagram%20Problem%20Solving&description=Anagram%20Problem%20Solving">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&t=Anagram%20Problem%20Solving">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#the-problem">The problem</a></li>
    <li><a href="#the-steps">The steps</a>
      <ul>
        <li><a href="#read-file">Read file</a></li>
        <li><a href="#process-word">Process word</a></li>
      </ul>
    </li>
    <li><a href="#complexity">Complexity</a></li>
    <li><a href="#optimization">Optimization</a></li>
  </ul>
</nav>
    </div>
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Anagram Problem Solving
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2020-05-20 13:41:25 &#43;0300 &#43;0300" itemprop="datePublished">2020-05-20</time>
          
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/algorithms" rel="tag">algorithms</a>
            
             ,  
            <a class="tag-link" href="/tags/go" rel="tag">go</a>
            
             ,  
            <a class="tag-link" href="/tags/unicode" rel="tag">unicode</a>
            
             ,  
            <a class="tag-link" href="/tags/lcd-sort" rel="tag">lcd sort</a>
            
        </div>
        
      </div>
    </header>

  
    <div class="content" itemprop="articleBody">
      <h2 id="the-problem">The problem</h2>
<p>Given an input file that contains one word per line, as an output construct a list of all anagrams from that input file. Print those words to the console, where all words that are an anagram should each other should be on the same line.</p>
<p>Consider aspects such as Maintainability, Scalability, Performance, etc</p>
<h2 id="the-steps">The steps</h2>
<h3 id="read-file">Read file</h3>
<p>The only optimization of reading file is reading file line by line to not load the whole into memory.</p>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">filename := flag.String(&#34;f&#34;, &#34;sample.txt&#34;, &#34;file name&#34;)
flag.Parse()
file, err := os.Open(*filename)
if err != nil {
    log.Fatal(err)
}
defer file.Close()
a := newAnagrams() // out anagram struct
scanner := bufio.NewScanner(file)
for scanner.Scan() {
    a.put(strings.ToLower(scanner.Text()))
}

if err := scanner.Err(); err != nil {
     log.Fatal(err)
}
</code></pre></div><h3 id="process-word">Process word</h3>
<p>During word processing we have to pay attention to two word characteristics: length and character set:</p>
<blockquote>
<p>Two words are defined as anagrams if they do share the same letters, but are in a different order</p>
</blockquote>
<p>Firstly we group our words by <em>length</em> we use array where array index corresponds word length:</p>
<blockquote>
<p><code>car</code> to second element, <code>home</code> to third</p>
</blockquote>
<p>Each arrays element represents bucket of words. How shall we organize it? Here we pay attention to the unique character set.
If we sort letters inside each anagram word we get the same character set:</p>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">act, cat -&gt; sort -&gt; act, act
</code></pre></div><p>That means we can represent bucket as a map where <em>key</em> is a word ordered char set, <em>value</em> - an array of anagrams.</p>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">func newAnagrams() *anagrams {
	return &amp;anagrams{buckets: make([]map[string][]string, maxWordLength)}
}

func (a *anagrams) put(word string) {
	if len(word) == 0 {
		return
	}
	idx := len(word) - 1
	bucket := a.buckets[idx]
	if bucket == nil {
		bucket = make(map[string][]string)
		a.buckets[idx] = bucket
	}
	sorted := sortWord(word)
	bucket[sorted] = append(bucket[sorted], word)
}

func sortWord(word string) string {
	count := make([]int, alphabetLen)
	for _, r := range word {
		count[r]++
	}
	sorted := make([]rune, 0, len(word))
	for i, e := range count {
		if e == 0 {
			continue
		}
		for j := 0; j &lt; e; j++ {
			sorted = append(sorted, rune(i))
		}
	}
	return string(sorted)
}
</code></pre></div><h2 id="complexity">Complexity</h2>
<ul>
<li>Array access - constant time, O(1)</li>
<li>Sort letters in the word: linear time complexity, O(n) where <em>n</em> - length of the word</li>
<li>Map key access - constant time, O(1)</li>
<li>Sort anagrams, <a href="https://www.informit.com/articles/article.aspx?p=2180073&amp;seqNum=2">LSD string sort</a>: linear time complexity, O(n) where <em>n</em> - length of anagrams array</li>
</ul>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">func LCDSort(words []string, wLen int) []string {
	wsLen := len(words)
	aux := make([]string, wsLen)
	for d := wLen - 1; d &gt;= 0; d-- {
		count := make([]int, alphabetLen+1)
		for i := 0; i &lt; wsLen; i++ {
			count[words[i][d]-&#39;a&#39;+1] += 1
		}
		for i := 0; i &lt; alphabetLen; i++ {
			count[i+1] += count[i]
		}
		for i := 0; i &lt; wsLen; i++ {
			c := count[words[i][d]-&#39;a&#39;]
			aux[c] = words[i]
			count[words[i][d]-&#39;a&#39;] += 1
		}
		for i := 0; i &lt; wsLen; i++ {
			words[i] = aux[i]
		}
	}
	return words
}
</code></pre></div><h2 id="optimization">Optimization</h2>
<p>I compared two version of program: <em>sequential</em> and <em>concurrent</em> on a big(466 551 words file)</p>
<p>My macbook has 4 physical and 8 logical cpu:</p>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">sctl hw.physicalcpu hw.logicalcpu
</code></pre></div><blockquote>
<p>hw.physicalcpu: 4
hw.logicalcpu: 8</p>
</blockquote>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">go test -bench .
goos: darwin
goarch: amd64
pkg: github.com/sergii4/anagrams
BenchmarkSequential-8            	       2	 609577077 ns/op
BenchmarkConcurrent4Workers-8    	       2	 545940748 ns/op
BenchmarkConcurrent8Workers-8    	       2	 570692494 ns/op
BenchmarkConcurrent16Workers-8   	       2	 600963959 ns/op
</code></pre></div><p>Benchmark show that 4 concurrent program with 4 worker in worker pool is slightly faster than sequential:</p>
<blockquote>
<p>545940748 ns/op vs 609577077 ns/op
and more workers we have the slower program works</p>
</blockquote>
<p>My conclusion that concurrent and parallel (4, 8, 16 workers) program execution doesn&rsquo;t really speed up program and can even slows it down cause of <em>fork/join</em> overhead.</p>
<p><a href="https://github.com/sergii4/anagrams">GitHub Repo</a></p>

    </div>
  </article>

  
  





  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">All posts</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#the-problem">The problem</a></li>
    <li><a href="#the-steps">The steps</a>
      <ul>
        <li><a href="#read-file">Read file</a></li>
        <li><a href="#process-word">Process word</a></li>
      </ul>
    </li>
    <li><a href="#complexity">Complexity</a></li>
    <li><a href="#optimization">Optimization</a></li>
  </ul>
</nav>
    </div>

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&text=Anagram%20Problem%20Solving">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&title=Anagram%20Problem%20Solving">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&is_video=false&description=Anagram%20Problem%20Solving">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Anagram%20Problem%20Solving&body=Check out this article: https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&title=Anagram%20Problem%20Solving">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&title=Anagram%20Problem%20Solving">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&title=Anagram%20Problem%20Solving">
      <i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&title=Anagram%20Problem%20Solving">
      <i class="fab fa-digg fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&name=Anagram%20Problem%20Solving&description=Anagram%20Problem%20Solving">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fgetman.io%2fposts%2fanagram-problem-solving%2f&t=Anagram%20Problem%20Solving">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2021 Sergii Getman
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">All posts</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>



</html>
